# ============================================================================
# Nixpacks Configuration - Didin Fácil / TikTrend
# ============================================================================
# Configuração mais leve para Railway
# ============================================================================

[phases.setup]
nixPkgs = [
  "python311",
  "python311Packages.pip",
  "postgresql",
  "ffmpeg",
  "chromium",
  "gcc",
  "glibc",
]

aptPkgs = [
  "libnss3",
  "libatk-bridge2.0-0",
  "libdrm2",
  "libxkbcommon0",
  "libgbm1",
  "libasound2t64",
  "libstdc++6",
]

[phases.install]
cmds = [
  "cd backend && pip install --break-system-packages -r requirements.txt",
  "playwright install chromium --with-deps || true",
]

[phases.build]
cmds = ["echo 'Build complete'"]

[start]
# Start command is defined in railway.toml

[variables]
PYTHONUNBUFFERED = "1"
NIX_LD_LIBRARY_PATH = "/nix/var/nix/profiles/default/lib:/usr/lib/x86_64-linux-gnu"
